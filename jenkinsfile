#!/usr/bin/env groovy

node('master') {
	try {
 
	stage('git-clone'){
		sh ('rm -rf harshavardhanc.github.io')

		sh ('git clone https://github.com/harshavardhanc/harshavardhanc.github.io.git')

		sh ('cd harshavardhanc.github.io && chmod 775 install_ansible.sh')
		}

	stage('Pre-Build'){
        sh('./harshavardhanc.github.io/install_ansible.sh')
	}

	stage('deploy') {
		sh 'cd harshavardhanc.github.io/inventory/ && chmod 600 newkey.pem
		sh 'ansible-playbook -i ./harshavardhanc.github.io/inventory/hosts ./harshavardhanc.github.io/main.yml --tags="apache2"'
		sh "echo 'Started running'"

	}

}

	catch (error) {
	    throw (error) 

    }



}
